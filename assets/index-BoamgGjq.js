import{_ as x,l as k,i as u,o as h,c as L,w as t,g as n,a as s,h as R,s as T,x as b,z as q,k as U,A as C,m as o,B as y,t as I,n as V,p as i,C as m,D as N,j as d}from"./index-DZBwqCr_.js";import"https://static.geetest.com/v4/gt4.js";import{i as B,g as f,r as z}from"./useRecaptcha-D4VPpSaq.js";import{V as A,a as g,b as D,c as v}from"./VTabs-BSfBPGr-.js";import{V as w}from"./VForm-BLOrn775.js";import{V as c}from"./VTextarea-DX95sL5Y.js";import{V as j}from"./VContainer-Oj8uSuDj.js";const F={data(){return{initRecaptcha:B,getResponse:f,resetCaptcha:z,UserCardLoading:!1,localuserinfo:k.user,UserInfo:{},tab:null,select:{state:"未知",abbr:"3"},items:[{state:"男",abbr:"0"},{state:"女",abbr:"1"},{state:"猫娘",abbr:"2"},{state:"未知",abbr:"3"}],valid:!1,nameRules:[r=>r?!0:"Name is required.",r=>(r==null?void 0:r.length)<=10?!0:"Name must be less than 10 characters.",r=>/^[a-z]+$/.test(r)?!0:"仅小写字母"],passwordRules:[r=>r?!0:"password is required.",r=>(r==null?void 0:r.length)<=10?!0:"Name must be less than 10 characters.",r=>/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[$@$!%*?&\.])[A-Za-z\d$@$!%*?&\.]{8,}/.test(r)?!0:"密码必须由数字、大小写字母和特殊字符组成，且长度至少为8位"],oldpassword:"",newpassword:"",passwordvalid:!1,usernamevalid:!1}},setup(){},async created(){await this.getuserinfo()},methods:{async getuserinfo(){this.UserInfo=await u({url:"/api/getuserinfo?id="+this.localuserinfo.userid,method:"get"}),this.UserInfo=this.UserInfo.info.user,this.select=this.items.find(r=>r.abbr==this.UserInfo.sex),this.UserCardLoading=!1,console.log(this.UserInfo)},async submit(){this.UserCardLoading=!0;const r=await u({url:"/my/set/userinfo",method:"post",data:{captcha:f()||"",display_name:this.UserInfo.display_name,aboutme:this.UserInfo.motto,sex:this.select.abbr}}).catch(e=>{console.log(e),this.$toast.add({severity:"error",summary:"错误",detail:e,life:3e3})});console.log(r.status),this.$toast.add({severity:"info",summary:"修改个人信息",detail:r.status,life:3e3}),await this.getuserinfo(),this.UserCardLoading=!1},async changeusername(){this.UserCardLoading=!0;const r=await u({url:"/my/set/username",method:"post",data:{captcha:f()||"",username:this.UserInfo.username}}).catch(e=>{console.log(e),this.$toast.add({severity:"error",summary:"错误",detail:e,life:3e3})});this.$toast.add({severity:"info",summary:"修改用户名",detail:r.status,life:3e3}),console.log(r.status),await this.getuserinfo(),this.UserCardLoading=!1},async changepassword(){this.UserCardLoading=!0;const r=await u({url:"/my/set/pw",method:"post",data:{captcha:f()||"",oldpw:this.oldpassword,newpw:this.newpassword}}).catch(e=>{console.log(e),this.$toast.add({severity:"error",summary:"错误",detail:e,life:3e3})});console.log(r.status),this.$toast.add({severity:"info",summary:"修改密码",detail:r.message,life:3e3}),await this.getuserinfo(),this.UserCardLoading=!1}}},S={class:"mb-2"},W={class:"font-weight-black"};function Z(r,e,P,E,l,p){return h(),L(j,null,{default:t(()=>[n("div",S,[s(I,{hover:"",border:"",class:"mx-auto",disabled:l.UserCardLoading,loading:l.UserCardLoading},{prepend:t(()=>[s(R,{class:"mb-2"},{default:t(()=>[s(T,{alt:l.UserInfo.display_name,src:"https://s4-1.wuyuan.1r.ink/user/"+l.UserInfo.images},null,8,["alt","src"])]),_:1})]),title:t(()=>[n("span",W,b(l.UserInfo.display_name),1)]),loader:t(({isActive:a})=>[s(q,{active:a,height:"4",indeterminate:""},null,8,["active"])]),subtitle:t(()=>[s(U,null,{default:t(()=>[s(C,{icon:"mdi-account-circle",start:""}),o(" ID:"+b(l.UserInfo.id),1)]),_:1}),s(U,null,{default:t(()=>[s(C,{icon:"mdi-tag",start:""}),e[17]||(e[17]=o(" 创作者"))]),_:1}),e[18]||(e[18]=n("span",{class:""},null,-1))]),default:t(()=>[s(y,{class:"bg-surface-light pt-4"},{default:t(()=>[o(b(l.UserInfo),1)]),_:1})]),_:1},8,["disabled","loading"])]),s(I,{hover:"",border:""},{default:t(()=>[s(A,{modelValue:l.tab,"onUpdate:modelValue":e[0]||(e[0]=a=>l.tab=a)},{default:t(()=>[s(g,{value:"userinfo"},{default:t(()=>e[19]||(e[19]=[o("用户信息")])),_:1}),s(g,{value:"username"},{default:t(()=>e[20]||(e[20]=[o("用户名")])),_:1}),s(g,{value:"password"},{default:t(()=>e[21]||(e[21]=[o("密码")])),_:1})]),_:1},8,["modelValue"]),s(y,null,{default:t(()=>[s(D,{modelValue:l.tab,"onUpdate:modelValue":e[16]||(e[16]=a=>l.tab=a)},{default:t(()=>[s(v,{value:"userinfo"},{default:t(()=>[s(w,{modelValue:l.valid,"onUpdate:modelValue":e[6]||(e[6]=a=>l.valid=a)},{default:t(()=>[s(V,null,{default:t(()=>[s(i,{cols:"12",md:"4"},{default:t(()=>[s(m,{modelValue:l.UserInfo.display_name,"onUpdate:modelValue":e[1]||(e[1]=a=>l.UserInfo.display_name=a),counter:10,label:"显示名称",required:""},null,8,["modelValue"])]),_:1}),s(i,{cols:"12",md:"12"},{default:t(()=>[s(c,{label:"显示简介",modelValue:l.UserInfo.motto,"onUpdate:modelValue":e[2]||(e[2]=a=>l.UserInfo.motto=a),counter:500},null,8,["modelValue"])]),_:1}),s(i,{cols:"12",md:"4"},{default:t(()=>[s(N,{modelValue:l.select,"onUpdate:modelValue":e[3]||(e[3]=a=>l.select=a),items:l.items,"item-title":"state","item-value":"abbr",label:"性别","persistent-hint":"","return-object":""},null,8,["modelValue","items"])]),_:1}),s(i,{cols:"12"},{default:t(()=>[e[24]||(e[24]=n("div",{id:"recaptcha-div1"},null,-1)),s(d,{onClick:e[4]||(e[4]=a=>l.initRecaptcha("recaptcha-div1","popup")),variant:"text",border:""},{default:t(()=>e[22]||(e[22]=[o("加载验证码")])),_:1}),s(d,{onClick:e[5]||(e[5]=a=>l.resetCaptcha()),variant:"text",border:""},{default:t(()=>e[23]||(e[23]=[o("刷新")])),_:1})]),_:1}),s(i,{cols:"12"},{default:t(()=>[s(d,{onClick:p.submit,disabled:!l.valid,border:""},{default:t(()=>e[25]||(e[25]=[o(" 提交 ")])),_:1},8,["onClick","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),s(v,{value:"username"},{default:t(()=>[s(w,{modelValue:l.usernamevalid,"onUpdate:modelValue":e[10]||(e[10]=a=>l.usernamevalid=a)},{default:t(()=>[s(V,null,{default:t(()=>[s(i,{cols:"12",md:"4"},{default:t(()=>[s(m,{modelValue:l.UserInfo.username,"onUpdate:modelValue":e[7]||(e[7]=a=>l.UserInfo.username=a),counter:10,rules:l.nameRules,label:"用户名",required:""},null,8,["modelValue","rules"])]),_:1}),s(i,{cols:"12"},{default:t(()=>[e[28]||(e[28]=n("div",{id:"recaptcha-div2"},null,-1)),s(d,{onClick:e[8]||(e[8]=a=>l.initRecaptcha("recaptcha-div2","popup")),variant:"text",border:""},{default:t(()=>e[26]||(e[26]=[o("加载验证码")])),_:1}),s(d,{onClick:e[9]||(e[9]=a=>l.resetCaptcha()),variant:"text",border:""},{default:t(()=>e[27]||(e[27]=[o("刷新")])),_:1})]),_:1}),s(i,{cols:"12"},{default:t(()=>[s(d,{onClick:p.changeusername,disabled:!l.usernamevalid,border:""},{default:t(()=>e[29]||(e[29]=[o(" 提交 ")])),_:1},8,["onClick","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),s(v,{value:"password"},{default:t(()=>[s(w,{modelValue:l.passwordvalid,"onUpdate:modelValue":e[15]||(e[15]=a=>l.passwordvalid=a)},{default:t(()=>[s(V,null,{default:t(()=>[s(i,{cols:"12",md:"8"},{default:t(()=>[s(m,{modelValue:l.oldpassword,"onUpdate:modelValue":e[11]||(e[11]=a=>l.oldpassword=a),hint:"此框不验证输入值",label:"原密码",required:""},null,8,["modelValue"])]),_:1}),s(i,{cols:"12",md:"8"},{default:t(()=>[s(m,{modelValue:l.newpassword,"onUpdate:modelValue":e[12]||(e[12]=a=>l.newpassword=a),rules:l.passwordRules,label:"新密码",required:""},null,8,["modelValue","rules"])]),_:1}),s(i,{cols:"12"},{default:t(()=>[e[32]||(e[32]=n("div",{id:"recaptcha-div3"},null,-1)),s(d,{onClick:e[13]||(e[13]=a=>l.initRecaptcha("recaptcha-div3","popup")),variant:"text",border:""},{default:t(()=>e[30]||(e[30]=[o("加载验证码")])),_:1}),s(d,{onClick:e[14]||(e[14]=a=>l.resetCaptcha()),variant:"text",border:""},{default:t(()=>e[31]||(e[31]=[o("刷新")])),_:1})]),_:1}),s(i,{cols:"12"},{default:t(()=>[s(d,{onClick:p.changepassword,disabled:!l.passwordvalid,border:""},{default:t(()=>e[33]||(e[33]=[o(" 提交 ")])),_:1},8,["onClick","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})}const X=x(F,[["render",Z]]);export{X as default};
